/**
 * amis-core v6.13.0
 * Copyright 2018-2025 fex
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var helper = require('./utils/helper.js');
var isPlainObject = require('lodash/isPlainObject');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var isPlainObject__default = /*#__PURE__*/_interopDefaultLegacy(isPlainObject);

/**
 * @file 用于在移动端或不同语言环境下使用不同配置
 */
var _a, _b;
var isMobile = ((_b = (_a = window).matchMedia) === null || _b === void 0 ? void 0 : _b.call(_a, '(max-width: 768px)').matches)
    ? true
    : false;
// 这里不能用 addSchemaFilter 是因为还需要更深层的替换，比如 select 里的 options
var envOverwrite = function (schema, locale, device) {
    var isMobileDevice = device === 'mobile' || isMobile;
    return helper.JSONValueMap(schema, function (value) {
        if (!isPlainObject__default["default"](value)) {
            return value;
        }
        if (locale && value[locale]) {
            var newValue = Object.assign({}, value, value[locale]);
            delete newValue[locale];
            return newValue;
        }
        else if (isMobileDevice && value.mobile) {
            var newValue = Object.assign({}, value, value.mobile);
            delete newValue.mobile;
            return newValue;
        }
    }, true);
};

exports.envOverwrite = envOverwrite;
