/**
 * amis-core v6.13.0
 * Copyright 2018-2025 fex
 */

import { parse } from 'amis-formula';
import VisitedCache from './visitedCache.js';

// NOTE 缓存前40条表达式
var cache = new VisitedCache(40);
function memoryParse(input, options) {
    if (options === void 0) { options = {
        evalMode: false
    }; }
    // 优化内存缓存释放，比如只缓存最高频的模版
    if (typeof input !== 'string') {
        return;
    }
    var key = input + JSON.stringify(options);
    // get cache result
    if (cache.has(key)) {
        return cache.get(key);
    }
    // run parse function and cache
    var ast = parse(input, options);
    cache.set(key, ast);
    return ast;
}

export { memoryParse };
