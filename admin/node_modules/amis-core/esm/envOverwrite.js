/**
 * amis-core v6.13.0
 * Copyright 2018-2025 fex
 */

import { JSONValueMap } from './utils/helper.js';
import isPlainObject from 'lodash/isPlainObject';

/**
 * @file 用于在移动端或不同语言环境下使用不同配置
 */
var _a, _b;
var isMobile = ((_b = (_a = window).matchMedia) === null || _b === void 0 ? void 0 : _b.call(_a, '(max-width: 768px)').matches)
    ? true
    : false;
// 这里不能用 addSchemaFilter 是因为还需要更深层的替换，比如 select 里的 options
var envOverwrite = function (schema, locale, device) {
    var isMobileDevice = device === 'mobile' || isMobile;
    return JSONValueMap(schema, function (value) {
        if (!isPlainObject(value)) {
            return value;
        }
        if (locale && value[locale]) {
            var newValue = Object.assign({}, value, value[locale]);
            delete newValue[locale];
            return newValue;
        }
        else if (isMobileDevice && value.mobile) {
            var newValue = Object.assign({}, value, value.mobile);
            delete newValue.mobile;
            return newValue;
        }
    }, true);
};

export { envOverwrite };
