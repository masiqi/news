import { __awaiter, __generator, __values } from 'tslib';
import { xml2json } from '../util/xml.js';

/**
 * 解析 relationship 的 xml 文件
 */
function parseRelationship(xml) {
    return __awaiter(this, void 0, void 0, function () {
        var relationships, node, _a, _b, child;
        var e_1, _c;
        return __generator(this, function (_d) {
            switch (_d.label) {
                case 0:
                    relationships = [];
                    if (!xml) return [3 /*break*/, 2];
                    return [4 /*yield*/, xml2json(xml)];
                case 1:
                    node = _d.sent();
                    try {
                        for (_a = __values(node.children || []), _b = _a.next(); !_b.done; _b = _a.next()) {
                            child = _b.value;
                            if (child.tag === 'Relationship') {
                                relationships.push({
                                    id: child.attrs.Id,
                                    target: child.attrs.Target,
                                    targetMode: child.attrs.TargetMode,
                                    type: child.attrs.Type
                                });
                            }
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                    return [2 /*return*/, relationships];
                case 2: return [2 /*return*/, []];
            }
        });
    });
}

export { parseRelationship };
