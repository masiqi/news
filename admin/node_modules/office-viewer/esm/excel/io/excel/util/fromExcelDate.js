var pasteCache = {};
/**
 * 将 Excel 日期转换为 Date 对象
 * 来自 https://github.com/RaschidJFR/js-excel-date-convert
 * @param excelDate Excel 日期
 * @param date1904 是否使用 1904 年作为基准
 */
function fromExcelDate(excelDate, date1904) {
    var cacheKey = "".concat(excelDate, "-").concat(date1904);
    if (pasteCache[cacheKey]) {
        return new Date(pasteCache[cacheKey]);
    }
    if (typeof excelDate === 'string') {
        excelDate = parseInt(excelDate, 10);
    }
    var daysIn4Years = 1461;
    var daysIn70years = Math.round(25567.5 + 1); // +1 because of the leap-year bug
    var daysFrom1900 = excelDate + (date1904 ? daysIn4Years + 1 : 0);
    var daysFrom1970 = daysFrom1900 - daysIn70years;
    var secondsFrom1970 = daysFrom1970 * (3600 * 24);
    var utc = new Date(secondsFrom1970 * 1000);
    pasteCache[cacheKey] = utc.getTime();
    return utc;
}

export { fromExcelDate };
