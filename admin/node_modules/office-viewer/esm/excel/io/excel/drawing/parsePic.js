import { autoParse } from '../../../../common/autoParse.js';
import { CT_Picture_Attributes } from '../../../../openxml/ExcelTypes.js';
import { getRelationPath } from './getRelationPath.js';

var picId = 0;
function parsePic(child, relationships, parser, drawingPath) {
    var _a, _b;
    var pic = autoParse(child, CT_Picture_Attributes);
    var embedId = (_b = (_a = pic.blipFill) === null || _a === void 0 ? void 0 : _a.blip) === null || _b === void 0 ? void 0 : _b['r:embed'];
    if (embedId) {
        var imagePath = getRelationPath(drawingPath, relationships, embedId);
        if (imagePath) {
            var data = parser.getFileByType(imagePath, 'blob');
            if (data && URL.createObjectURL) {
                pic.imgURL = URL.createObjectURL(data);
                pic.gid = "pic-".concat(picId++);
            }
        }
    }
    return pic;
}

export { parsePic };
