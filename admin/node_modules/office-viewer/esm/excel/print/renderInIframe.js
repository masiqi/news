import { MAX_ROW, MAX_COL } from '../render/Consts.js';
import { rangeToHTML } from '../render/selection/buildHTML/rangeToHTML.js';
import { printStyle } from './printStyle.js';

/**
 * 目前打印基于拷贝功能实现，所以还不支持图表及图片等 drawing 元素
 * @param iframe
 * @param workbook
 */
function renderInIframe(iframe, workbook) {
    var printDocument = iframe.contentDocument;
    var allRange = {
        startRow: 0,
        startCol: 0,
        endRow: MAX_ROW,
        endCol: MAX_COL
    };
    var table = rangeToHTML(workbook, allRange).table;
    var borderColor = workbook.renderOptions.gridLineColor;
    if (workbook.getActiveSheet().showGridLines() === false) {
        borderColor = 'transparent';
    }
    printDocument.write(printStyle(borderColor) + table);
}

export { renderInIframe };
