import { drawTopFrozen } from './drawTopFrozen.js';
import { drawLeftFrozen } from './drawLeftFrozen.js';
import { drawTopLeftFrozen } from './drawTopLeftFrozen.js';

/**
 * 绘制冻结的行和列
 * @return 绘制区域的信息
 */
function drawFrozen(excelRender, currentSheet, dataProvider, excelRenderOptions, mainCanvas, height, width, linkPositionCache) {
    var xSplit = 0;
    var ySplit = 0;
    var topViewRange = null;
    var leftViewRange = null;
    var topLeftViewRange = null;
    var currentSheetView = currentSheet.getCurrentSheetView();
    // 目前先只支持 top-left 这两种方式
    if (currentSheetView === null || currentSheetView === void 0 ? void 0 : currentSheetView.pane) {
        var pane = currentSheetView === null || currentSheetView === void 0 ? void 0 : currentSheetView.pane;
        if (pane.xSplit) {
            xSplit = pane.xSplit;
        }
        if (pane.ySplit) {
            ySplit = pane.ySplit;
        }
    }
    if (xSplit > 0 && ySplit > 0) {
        var rangeResult = drawTopLeftFrozen(excelRender, xSplit, ySplit, currentSheet, dataProvider, excelRenderOptions, mainCanvas, height, width, linkPositionCache);
        topViewRange = rangeResult.topViewRange;
        leftViewRange = rangeResult.leftViewRange;
        topLeftViewRange = rangeResult.topLeftViewRange;
    }
    else if (ySplit > 0) {
        topViewRange = drawTopFrozen(excelRender, ySplit, currentSheet, dataProvider, excelRenderOptions, mainCanvas, width, linkPositionCache);
    }
    else if (xSplit > 0) {
        leftViewRange = drawLeftFrozen(excelRender, xSplit, currentSheet, dataProvider, excelRenderOptions, mainCanvas, height, linkPositionCache);
    }
    return {
        topViewRange: topViewRange,
        leftViewRange: leftViewRange,
        topLeftViewRange: topLeftViewRange
    };
}

export { drawFrozen };
