import { drawGridLines } from '../../grid/drawGridLines.js';
import { drawCells } from '../drawCells.js';
import { drawRowColHeaders } from '../../header/drawRowColHeaders.js';

/**
 * 绘制只有上边冻结的情况
 */
function drawTopFrozen(excelRender, ySplit, currentSheet, dataProvider, excelRenderOptions, mainCanvas, width, linkPositionCache) {
    var frozenViewRange = currentSheet.getFrozenTopViewPointRange(ySplit, width);
    // 获取可视区域内的信息
    var displayData = currentSheet.getViewPointData(frozenViewRange);
    mainCanvas.drawRect(0, 0, frozenViewRange.width, frozenViewRange.height, excelRenderOptions.cellBackgroundColor);
    drawCells(excelRender, currentSheet, excelRenderOptions, mainCanvas, displayData, linkPositionCache);
    drawGridLines(currentSheet, frozenViewRange, mainCanvas, frozenViewRange.height, frozenViewRange.width, excelRenderOptions);
    drawRowColHeaders(currentSheet, frozenViewRange, mainCanvas, excelRenderOptions, dataProvider.getDefaultFontSize(), dataProvider.getDefaultFontStyle());
    // 绘制冻结分割线
    mainCanvas.drawLine({
        x1: 0,
        y1: frozenViewRange.height,
        x2: frozenViewRange.width,
        y2: frozenViewRange.height
    }, excelRenderOptions.frozenLineColor);
    return frozenViewRange;
}

export { drawTopFrozen };
