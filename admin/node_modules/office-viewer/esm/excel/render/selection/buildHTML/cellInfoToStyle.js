import { getBackgroundColor } from '../../cell/getBackgroundColor.js';
import { buildBorder } from './buildBorder.js';

/**
 * 生成单元格样式
 */
function cellInfoToStyle(workbook, cellInfo) {
    var style = '';
    var dataProvider = workbook.getDataProvider();
    var fontStyle = dataProvider.getFontStyle(cellInfo.font);
    if (fontStyle.b) {
        style += 'font-weight: bold;';
    }
    if (fontStyle.i) {
        style += 'font-style: italic;';
    }
    if (fontStyle.u === 'single') {
        style += 'text-decoration: underline;';
    }
    if (fontStyle.strike) {
        style += 'text-decoration: line-through;';
    }
    if (fontStyle.color) {
        style += "color: ".concat(fontStyle.color, ";");
    }
    if (fontStyle.size) {
        style += "font-size: ".concat(fontStyle.size, "pt;");
    }
    if (fontStyle.family) {
        style += "font-family: ".concat(fontStyle.family, ";");
    }
    if (cellInfo.fill) {
        var dataProvider_1 = workbook.getDataProvider();
        var backgroundColor = getBackgroundColor(dataProvider_1, cellInfo.fill);
        if (backgroundColor !== 'none') {
            style += "background-color: ".concat(backgroundColor, ";");
        }
    }
    if (cellInfo.alignment) {
        if (cellInfo.alignment.horizontal) {
            style += "text-align: ".concat(cellInfo.alignment.horizontal, ";");
        }
        if (cellInfo.alignment.vertical) {
            style += "vertical-align: ".concat(cellInfo.alignment.vertical, ";");
        }
    }
    if (cellInfo.border) {
        var dataProvider_2 = workbook.getDataProvider();
        var border = cellInfo.border;
        if (border.left) {
            style += buildBorder('border-left', border.left, dataProvider_2);
        }
        if (border.right) {
            style += buildBorder('border-right', border.right, dataProvider_2);
        }
        if (border.top) {
            style += buildBorder('border-top', border.top, dataProvider_2);
        }
        if (border.bottom) {
            style += buildBorder('border-bottom', border.bottom, dataProvider_2);
        }
    }
    return style;
}

export { cellInfoToStyle };
