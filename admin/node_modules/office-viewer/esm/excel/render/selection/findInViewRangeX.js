import { binarySearchSize } from './binarySearchSize.js';

/**
 * 在视图范围水平方向内查找
 */
function findInViewRangeX(offsetX, viewRange, gridLineHitRange, 
// 是否在是 header 区域
isHeader) {
    if (isHeader === void 0) { isHeader = false; }
    var x = 0;
    var width = 0;
    var colIndex = binarySearchSize(viewRange.colSizes, offsetX);
    var col = -1;
    // 点到线上还是点到单元格上
    var type = 'cell';
    if (isHeader) {
        type = 'col-header';
    }
    if (colIndex !== -1) {
        x = viewRange.colSizes[colIndex].offset;
        width = viewRange.colSizes[colIndex].size;
        col = viewRange.cols[colIndex];
        if (isHeader) {
            // 点到了顶部单元格
            if (x + width - offsetX < gridLineHitRange) {
                type = 'col-grid';
            }
            // 点到了左边的线
            if (offsetX - x < gridLineHitRange) {
                type = 'col-grid';
                if (colIndex > 0) {
                    x = viewRange.colSizes[colIndex - 1].offset;
                    width = viewRange.colSizes[colIndex - 1].size;
                    col = viewRange.cols[colIndex - 1];
                }
            }
        }
    }
    return { col: col, x: x, width: width, type: type };
}

export { findInViewRangeX };
