import { rangeToHTML } from './buildHTML/rangeToHTML.js';

/**
 * 复制选区，生成 HTML 表格数据
 * @param range 选区
 * @param mergeCells 合并单元格
 */
function copySelection(workbook) {
    var currentSheet = workbook.getActiveSheet();
    var selection = currentSheet.getSelection();
    if (!(selection === null || selection === void 0 ? void 0 : selection.cellRanges)) {
        console.warn('没有 selection');
        return;
    }
    if (selection.cellRanges.length === 0) {
        return;
    }
    var _a = rangeToHTML(workbook, selection.cellRanges[0]), tsv = _a.tsv, table = _a.table;
    navigator.clipboard.write([
        new ClipboardItem({
            'text/plain': new Blob([tsv.join('\n')], { type: 'text/plain' }),
            'text/html': new Blob([table], { type: 'text/html' })
        })
    ]);
    workbook.uiEvent.emit('COPY_SELECTION');
}

export { copySelection };
