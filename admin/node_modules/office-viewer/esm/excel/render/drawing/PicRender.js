import { __extends } from 'tslib';
import { BaseDrawingRender } from './BaseDrawingRender.js';

var PicRender = /** @class */ (function (_super) {
    __extends(PicRender, _super);
    function PicRender(container, displayRect, gid, pic) {
        var _this = this;
        var _a;
        _this = _super.call(this, container, displayRect, gid, 'excel-pic') || this;
        if (!pic.imgURL) {
            console.warn('imgURL do not exist');
            return _this;
        }
        var srcRect = (_a = pic.blipFill) === null || _a === void 0 ? void 0 : _a.srcRect;
        var img = new Image();
        img.src = pic.imgURL;
        if (srcRect) {
            // 根据 srcRect 的百分比来设置图片的位置及大小
            var containerWidth = displayRect.width;
            var containerHeight = displayRect.height;
            var leftPercent = 0;
            if (srcRect.l) {
                leftPercent = parseInt(srcRect.l, 10) / 100000;
            }
            var topPercent = 0;
            if (srcRect.t) {
                topPercent = parseInt(srcRect.t, 10) / 100000;
            }
            var bottomPercent = 0;
            if (srcRect.b) {
                bottomPercent = parseInt(srcRect.b, 10) / 100000;
            }
            var rightPercent = 0;
            if (srcRect.r) {
                rightPercent = parseInt(srcRect.r, 10) / 100000;
            }
            var width = containerWidth * (1 + leftPercent + rightPercent);
            var height = containerHeight * (1 + topPercent + bottomPercent);
            var top_1 = -containerHeight * topPercent;
            var left = -containerWidth * leftPercent;
            img.style.width = "".concat(width, "px");
            img.style.height = "".concat(height, "px");
            img.style.top = "".concat(top_1, "px");
            img.style.left = "".concat(left, "px");
            img.style.position = 'absolute';
        }
        else {
            img.style.height = '100%';
            img.style.width = '100%';
        }
        _this.drawingContainer.appendChild(img);
        return _this;
    }
    return PicRender;
}(BaseDrawingRender));

export { PicRender };
