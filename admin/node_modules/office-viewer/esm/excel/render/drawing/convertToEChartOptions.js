import { __assign } from 'tslib';
import { fromBarChart } from './chart/fromBarChart.js';
import { fromAreaChart } from './chart/fromAreaChart.js';
import { convertAxis } from './chart/convertAxis.js';
import { convertLegend } from './chart/convertLegend.js';
import { convertTitle } from './chart/convertTitle.js';
import { fromDoughnutChart } from './chart/fromDoughnutChart.js';
import { fromLineChart } from './chart/fromLineChart.js';
import { fromPieChart } from './chart/fromPieChart.js';

/**
 * 将 chartSpace 配置转成 EChartOptions
 * P3365
 */
function convertToEChartOptions(workbook, chartSpace) {
    var chart = chartSpace.chart;
    console.log('chart', chart);
    if (!chart) {
        return null;
    }
    var title = convertTitle(chart.title);
    var grid = {
        backgroundColor: 'white',
        show: true
    };
    var echartsOptions = {
        title: title,
        grid: grid
    };
    var plotArea = chart.plotArea;
    if (!plotArea) {
        return null;
    }
    var categories = [];
    var series = [];
    if (plotArea.lineChart) {
        var result = fromLineChart(workbook, plotArea.lineChart);
        categories = result.categories;
        series = series.concat(result.series);
    }
    if (plotArea.barChart) {
        var result = fromBarChart(workbook, plotArea.barChart);
        categories = result.categories;
        series = series.concat(result.series);
    }
    if (plotArea.areaChart) {
        var result = fromAreaChart(workbook, plotArea.areaChart);
        categories = result.categories;
        series = series.concat(result.series);
    }
    if (plotArea.pieChart) {
        var result = fromPieChart(workbook, plotArea.pieChart);
        categories = result.categories;
        series = series.concat(result.series);
    }
    if (plotArea.doughnutChart) {
        var result = fromDoughnutChart(workbook, plotArea.doughnutChart);
        categories = result.categories;
        series = series.concat(result.series);
    }
    var _a = convertAxis(categories, plotArea.catAx, plotArea.valAx), xAxis = _a.xAxis, yAxis = _a.yAxis;
    var legend = convertLegend(categories, chart.legend);
    return __assign(__assign({}, echartsOptions), { legend: legend, xAxis: xAxis, yAxis: yAxis, series: series });
}

export { convertToEChartOptions };
