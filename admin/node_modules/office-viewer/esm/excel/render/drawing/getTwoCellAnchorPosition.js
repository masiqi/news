import { emuToPx } from '../../../util/emuToPx.js';

function getTwoCellAnchorPosition(twoCellAnchor, sheet) {
    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;
    var from = (_a = twoCellAnchor.from) === null || _a === void 0 ? void 0 : _a[0];
    var to = (_b = twoCellAnchor.to) === null || _b === void 0 ? void 0 : _b[0];
    if (!from || !to) {
        return {
            x: 0,
            y: 0,
            width: 0,
            height: 0
        };
    }
    var fromRow = ((_c = from.row) === null || _c === void 0 ? void 0 : _c[0]) || 0;
    var fromRowOffset = emuToPx((_d = from.rowOff) === null || _d === void 0 ? void 0 : _d[0]);
    var fromCol = ((_e = from.col) === null || _e === void 0 ? void 0 : _e[0]) || 0;
    var fromColOffset = emuToPx((_f = from.colOff) === null || _f === void 0 ? void 0 : _f[0]);
    var fromPosition = sheet.getCellPosition(fromRow, fromCol);
    var toRow = ((_g = to.row) === null || _g === void 0 ? void 0 : _g[0]) || 0;
    var toRowOffset = emuToPx((_h = to.rowOff) === null || _h === void 0 ? void 0 : _h[0]);
    var toCol = ((_j = to.col) === null || _j === void 0 ? void 0 : _j[0]) || 0;
    var toColOffset = emuToPx((_k = to.colOff) === null || _k === void 0 ? void 0 : _k[0]);
    var toPosition = sheet.getCellPosition(toRow, toCol);
    var x = fromPosition.x + fromColOffset;
    var y = fromPosition.y + fromRowOffset;
    var width = toPosition.x + toColOffset - x;
    var height = toPosition.y + toRowOffset - y;
    return {
        x: x,
        y: y,
        width: width,
        height: height
    };
}

export { getTwoCellAnchorPosition };
