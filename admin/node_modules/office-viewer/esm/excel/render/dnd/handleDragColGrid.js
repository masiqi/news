import { getCellColPosition } from '../selection/getCellPosition.js';
import { dragState } from './handleMousedown.js';

/**
 * 处理拖拽网格线，调整列宽
 */
function handleDragColGrid(mouseEvent) {
    var pageX = mouseEvent.pageX;
    var shiftX = pageX - dragState.dragStart.pageX;
    var workbook = dragState.workbook;
    var sheet = workbook.getActiveSheet();
    var colPosition = getCellColPosition(sheet, dragState.region, dragState.col);
    if (colPosition) {
        // 拖拽的网格线是在右边
        var startX = colPosition.x + colPosition.width;
        // 不可以拖动超过当前列的位置，这样就变成负值了
        var lineX = Math.max(colPosition.x, startX + shiftX);
        dragState.tmpColWidth = Math.max(0, lineX - colPosition.x);
        workbook.uiEvent.emit('DRAG_COL_GRID_LINE', lineX);
    }
}

export { handleDragColGrid };
