import { getCellRowPosition } from '../selection/getCellPosition.js';
import { dragState } from './handleMousedown.js';

/**
 * 处理拖拽网格线，调整行高
 */
function handleDragRowGrid(mouseEvent) {
    var pageY = mouseEvent.pageY;
    var shiftY = pageY - dragState.dragStart.pageY;
    var workbook = dragState.workbook;
    var sheet = workbook.getActiveSheet();
    var rowPosition = getCellRowPosition(sheet, dragState.region, dragState.row);
    if (rowPosition) {
        // 拖拽的网格线是在底部
        var startY = rowPosition.y + rowPosition.height;
        // 不可以拖动超过当前行的位置，这样就变成负值了
        var lineY = Math.max(rowPosition.y, startY + shiftY);
        dragState.tmpRowHeight = Math.max(0, lineY - rowPosition.y);
        workbook.uiEvent.emit('DRAG_ROW_GRID_LINE', lineY);
    }
}

export { handleDragRowGrid };
