import { __values, __read } from 'tslib';
import { applyColor } from './applyColor.js';

/**
 * 绘制柱状图
 */
function renderColumn(ctx, width, height, min, max, data, sparklineOptions, getColor) {
    var e_1, _a;
    var color = getColor(sparklineOptions['x14:colorSeries']);
    // 柱状图之间的间隔
    var gap = 2;
    var diff = max - min;
    // 只有一个点就只绘制中间
    ctx.fillStyle = color;
    if (data.length === 1) {
        var firstData = data[0];
        if (firstData !== undefined) {
            var columnWidth_1 = 6;
            ctx.fillRect(width / 2 - 1, height - ((firstData - min) / diff) * height, columnWidth_1, ((firstData - min) / diff) * height);
        }
        return;
    }
    var columnWidth = (width - gap * (data.length - 1)) / data.length;
    var minColumnHeight = 1;
    try {
        for (var _b = __values(data.entries()), _c = _b.next(); !_c.done; _c = _b.next()) {
            var _d = __read(_c.value, 2), index = _d[0], value = _d[1];
            if (value === undefined) {
                continue;
            }
            applyColor(ctx, data, index, value, min, max, sparklineOptions, color, getColor);
            var x = index * (columnWidth + gap);
            var columnHeight = Math.max(minColumnHeight, ((value - min) / diff) * height);
            var y = height - columnHeight;
            ctx.fillRect(x, y, columnWidth, columnHeight);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
}

export { renderColumn };
