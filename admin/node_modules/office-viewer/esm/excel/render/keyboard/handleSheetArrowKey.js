import { MAX_ROW, MAX_COL } from '../Consts.js';

/**
 * 在 sheet canvas 上的事件
 */
function handleSheetCanvasKeydown(e, workbook) {
    var _a;
    var currentSheet = workbook.getActiveSheet();
    var activeCell = (_a = currentSheet.selection) === null || _a === void 0 ? void 0 : _a.activeCell;
    if (!activeCell) {
        return;
    }
    var changeActiveCell = false;
    if (e.key === 'ArrowUp') {
        activeCell.startRow = Math.max(0, activeCell.startRow - 1);
        changeActiveCell = true;
    }
    if (e.key === 'ArrowDown') {
        activeCell.startRow = Math.min(MAX_ROW, activeCell.startRow + 1);
        changeActiveCell = true;
    }
    if (e.key === 'ArrowLeft') {
        activeCell.startCol = Math.max(0, activeCell.startCol - 1);
        changeActiveCell = true;
    }
    if (e.key === 'ArrowRight') {
        activeCell.startCol = Math.min(MAX_COL, activeCell.startCol + 1);
        changeActiveCell = true;
    }
    if (changeActiveCell) {
        e.preventDefault();
        activeCell.endRow = activeCell.startRow;
        activeCell.endCol = activeCell.startCol;
        if (currentSheet.selection) {
            currentSheet.selection.cellRanges = [activeCell];
            workbook.uiEvent.emit('CHANGE_SELECTION', currentSheet.selection);
        }
    }
}

export { handleSheetCanvasKeydown };
