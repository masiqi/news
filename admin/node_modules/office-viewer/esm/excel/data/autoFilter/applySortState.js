import { __values } from 'tslib';
import { parseRange } from '../../io/excel/util/Range.js';

/**
 * 应用排序状态
 */
function applySortState(sheetIndex, dataProvider, autoFilter, headerRowCount) {
    var e_1, _a;
    if (headerRowCount === void 0) { headerRowCount = 1; }
    var sortState = autoFilter.sortState;
    if (!sortState) {
        return;
    }
    try {
        for (var _b = __values(sortState.sortCondition || []), _c = _b.next(); !_c.done; _c = _b.next()) {
            var sortCondition = _c.value;
            var ref = sortCondition.ref;
            if (!ref) {
                continue;
            }
            var rangeRef = parseRange(ref);
            rangeRef.startRow += headerRowCount;
            var sortOrder = sortCondition.descending ? 'desc' : 'asc';
            dataProvider.sortColumn(sheetIndex, rangeRef, sortOrder);
        }
    }
    catch (e_1_1) { e_1 = { error: e_1_1 }; }
    finally {
        try {
            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
        }
        finally { if (e_1) throw e_1.error; }
    }
}

export { applySortState };
