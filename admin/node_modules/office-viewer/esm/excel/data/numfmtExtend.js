import { amountInWords } from './numfmt/amountInWords.js';

/**
 * 应对 numfmt 不识别的情况
 */
function numfmtExtend(formatCode) {
    var numfmtInstance = function (val) {
        switch (formatCode) {
            case '[DBNum2][$RMB]General;[Red][DBNum2][$RMB]General':
                var num = parseFloat(val);
                if (isNaN(num)) {
                    return val;
                }
                return amountInWords(parseFloat(num.toFixed(2)));
            default:
                console.warn('numfmtExtend: formatCode not found', formatCode);
                return val;
        }
    };
    numfmtInstance.isDate = function () {
        return false;
    };
    numfmtInstance.info = {
        color: 0
    };
    return numfmtInstance;
}

export { numfmtExtend };
