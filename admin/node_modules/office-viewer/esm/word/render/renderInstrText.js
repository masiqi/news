import { __values } from 'tslib';
import { createElement } from '../../util/dom.js';
import renderInlineText from './renderInlineText.js';

/**
 * 渲染字段指令，目前基本都没实现
 * http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/Field%20definitions.html
 * http://officeopenxml.com/WPfieldInstructions.php
 */
function renderInstrText(word, instrText) {
    var e_1, _a;
    var _b;
    var text = instrText.text;
    var span = createElement('span');
    var fldSimples = (_b = word.currentParagraph) === null || _b === void 0 ? void 0 : _b.fldSimples;
    if (fldSimples) {
        try {
            // 其实不知道这样做是不是对的
            // 另外就是这里有很多指令还不支持 http://webapp.docx4java.org/OnlineDemo/ecma376/WordML/FILENAME.html
            for (var fldSimples_1 = __values(fldSimples), fldSimples_1_1 = fldSimples_1.next(); !fldSimples_1_1.done; fldSimples_1_1 = fldSimples_1.next()) {
                var fldSimple = fldSimples_1_1.value;
                if (fldSimple.instr === text.trim() ||
                    text.startsWith(fldSimple.instr + ' ')) {
                    renderInlineText(word, fldSimple.inlineText, span);
                    break;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (fldSimples_1_1 && !fldSimples_1_1.done && (_a = fldSimples_1.return)) _a.call(fldSimples_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
    }
    return span;
}

export { renderInstrText };
