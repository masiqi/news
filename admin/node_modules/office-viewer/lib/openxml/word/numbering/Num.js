'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var tslib = require('tslib');
var OpenXML = require('../../../OpenXML.js');
var Lvl = require('./Lvl.js');

var Num = /** @class */ (function () {
    function Num() {
        this.lvlOverride = { lvls: {} };
    }
    Num.fromXML = function (word, element) {
        var e_1, _a;
        var num = new Num();
        num.numId = element.getAttribute('w:numId') || '';
        var abstractNumId = element
            .getElementsByTagName('w:abstractNumId')
            .item(0);
        if (abstractNumId) {
            num.abstractNumId = OpenXML.getVal(abstractNumId);
        }
        var lvlOverride = element.getElementsByTagName('w:lvlOverride').item(0);
        if (lvlOverride) {
            try {
                for (var _b = tslib.__values(lvlOverride.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var child = _c.value;
                    var tagName = child.tagName;
                    switch (tagName) {
                        case 'w:lvl':
                            var lvlId = child.getAttribute('w:lvlId') || '';
                            num.lvlOverride.lvls[lvlId] = Lvl.Lvl.fromXML(word, child);
                            break;
                        case 'w:startOverride':
                            var id = child.getAttribute('w:lvlId') || '';
                            if (num.lvlOverride.lvls[id]) {
                                num.lvlOverride.lvls[id].start = OpenXML.getValNumber(child);
                            }
                            break;
                        default:
                            console.warn("Num: Unknown tag ", tagName, child);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        return num;
    };
    return Num;
}());

exports.Num = Num;
