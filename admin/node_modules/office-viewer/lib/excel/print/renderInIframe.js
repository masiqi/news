'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var Consts = require('../render/Consts.js');
var rangeToHTML = require('../render/selection/buildHTML/rangeToHTML.js');
var printStyle = require('./printStyle.js');

/**
 * 目前打印基于拷贝功能实现，所以还不支持图表及图片等 drawing 元素
 * @param iframe
 * @param workbook
 */
function renderInIframe(iframe, workbook) {
    var printDocument = iframe.contentDocument;
    var allRange = {
        startRow: 0,
        startCol: 0,
        endRow: Consts.MAX_ROW,
        endCol: Consts.MAX_COL
    };
    var table = rangeToHTML.rangeToHTML(workbook, allRange).table;
    var borderColor = workbook.renderOptions.gridLineColor;
    if (workbook.getActiveSheet().showGridLines() === false) {
        borderColor = 'transparent';
    }
    printDocument.write(printStyle.printStyle(borderColor) + table);
}

exports.renderInIframe = renderInIframe;
