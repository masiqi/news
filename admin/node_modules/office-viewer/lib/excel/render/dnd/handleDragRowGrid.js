'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var getCellPosition = require('../selection/getCellPosition.js');
var handleMousedown = require('./handleMousedown.js');

/**
 * 处理拖拽网格线，调整行高
 */
function handleDragRowGrid(mouseEvent) {
    var pageY = mouseEvent.pageY;
    var shiftY = pageY - handleMousedown.dragState.dragStart.pageY;
    var workbook = handleMousedown.dragState.workbook;
    var sheet = workbook.getActiveSheet();
    var rowPosition = getCellPosition.getCellRowPosition(sheet, handleMousedown.dragState.region, handleMousedown.dragState.row);
    if (rowPosition) {
        // 拖拽的网格线是在底部
        var startY = rowPosition.y + rowPosition.height;
        // 不可以拖动超过当前行的位置，这样就变成负值了
        var lineY = Math.max(rowPosition.y, startY + shiftY);
        handleMousedown.dragState.tmpRowHeight = Math.max(0, lineY - rowPosition.y);
        workbook.uiEvent.emit('DRAG_ROW_GRID_LINE', lineY);
    }
}

exports.handleDragRowGrid = handleDragRowGrid;
