'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var getCellPosition = require('../selection/getCellPosition.js');
var handleMousedown = require('./handleMousedown.js');

/**
 * 处理拖拽网格线，调整列宽
 */
function handleDragColGrid(mouseEvent) {
    var pageX = mouseEvent.pageX;
    var shiftX = pageX - handleMousedown.dragState.dragStart.pageX;
    var workbook = handleMousedown.dragState.workbook;
    var sheet = workbook.getActiveSheet();
    var colPosition = getCellPosition.getCellColPosition(sheet, handleMousedown.dragState.region, handleMousedown.dragState.col);
    if (colPosition) {
        // 拖拽的网格线是在右边
        var startX = colPosition.x + colPosition.width;
        // 不可以拖动超过当前列的位置，这样就变成负值了
        var lineX = Math.max(colPosition.x, startX + shiftX);
        handleMousedown.dragState.tmpColWidth = Math.max(0, lineX - colPosition.x);
        workbook.uiEvent.emit('DRAG_COL_GRID_LINE', lineX);
    }
}

exports.handleDragColGrid = handleDragColGrid;
