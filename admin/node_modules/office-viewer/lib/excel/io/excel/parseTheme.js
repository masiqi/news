'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var tslib = require('tslib');
var autoParse = require('../../../common/autoParse.js');
var DMLTypes = require('../../../openxml/DMLTypes.js');
var xml = require('../../../util/xml.js');

/**
 * 解析主题，由于类型冲突，这里是用 DMLTypes
 * @param xml
 */
function parseTheme(xml$1) {
    var _a, _b;
    return tslib.__awaiter(this, void 0, void 0, function () {
        var node, theme, colorList, key, color;
        return tslib.__generator(this, function (_c) {
            switch (_c.label) {
                case 0:
                    if (!xml$1) {
                        throw new Error('xml is empty');
                    }
                    return [4 /*yield*/, xml.xml2json(xml$1)];
                case 1:
                    node = _c.sent();
                    theme = autoParse.autoParse(node, DMLTypes.CT_OfficeStyleSheet_Attributes, true);
                    colorList = [];
                    for (key in ((_a = theme === null || theme === void 0 ? void 0 : theme.themeElements) === null || _a === void 0 ? void 0 : _a.clrScheme) || {}) {
                        // 解析后包含了 name 属性，这里要过滤掉
                        if (key === 'name') {
                            continue;
                        }
                        color = (_b = theme === null || theme === void 0 ? void 0 : theme.themeElements) === null || _b === void 0 ? void 0 : _b.clrScheme[key];
                        colorList.push(color);
                    }
                    if (theme.themeElements) {
                        theme.themeElements.clrSchemes = colorList;
                    }
                    return [2 /*return*/, theme];
            }
        });
    });
}

exports.parseTheme = parseTheme;
