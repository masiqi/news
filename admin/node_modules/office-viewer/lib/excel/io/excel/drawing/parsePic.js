'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var autoParse = require('../../../../common/autoParse.js');
var ExcelTypes = require('../../../../openxml/ExcelTypes.js');
var getRelationPath = require('./getRelationPath.js');

var picId = 0;
function parsePic(child, relationships, parser, drawingPath) {
    var _a, _b;
    var pic = autoParse.autoParse(child, ExcelTypes.CT_Picture_Attributes);
    var embedId = (_b = (_a = pic.blipFill) === null || _a === void 0 ? void 0 : _a.blip) === null || _b === void 0 ? void 0 : _b['r:embed'];
    if (embedId) {
        var imagePath = getRelationPath.getRelationPath(drawingPath, relationships, embedId);
        if (imagePath) {
            var data = parser.getFileByType(imagePath, 'blob');
            if (data && URL.createObjectURL) {
                pic.imgURL = URL.createObjectURL(data);
                pic.gid = "pic-".concat(picId++);
            }
        }
    }
    return pic;
}

exports.parsePic = parsePic;
