# ğŸ‰ å¢¨é¦™è’¸é¦éƒ¨ç½²å®Œæˆæ€»ç»“

## âœ… å·²æˆåŠŸéƒ¨ç½²çš„ç»„ä»¶

### 1. åç«¯ API (Cloudflare Workers)
- **çŠ¶æ€**ï¼šâœ… å·²éƒ¨ç½²å¹¶è¿è¡Œ
- **åœ°å€**ï¼šhttps://moxiang-distill.masiqi.workers.dev
- **åŠŸèƒ½**ï¼š
  - ç”¨æˆ·è®¤è¯å’Œç®¡ç†
  - RSS æºç®¡ç†
  - æ–‡ç« æŠ“å–å’Œå¤„ç†
  - AI å†…å®¹åˆ†æ
  - R2 å­˜å‚¨é›†æˆ
  - é˜Ÿåˆ—å¤„ç†

**æµ‹è¯•å‘½ä»¤**ï¼š
```bash
curl https://moxiang-distill.masiqi.workers.dev/api/health
```

### 2. ç®¡ç†åå° (Cloudflare Pages)
- **çŠ¶æ€**ï¼šâœ… å·²éƒ¨ç½²å¹¶å¯è®¿é—®
- **åœ°å€**ï¼šhttps://moxiang-distill-admin.pages.dev
- **ä¸´æ—¶åœ°å€**ï¼šhttps://71eb74d8.moxiang-distill-admin.pages.dev

**ç™»å½•ä¿¡æ¯**ï¼š
- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`Admin@123456`

**åŠŸèƒ½**ï¼š
- ç”¨æˆ·ç®¡ç†
- RSS æºé…ç½®
- æ–‡ç« æŸ¥çœ‹
- ç³»ç»Ÿç›‘æ§
- é…ç½®ç®¡ç†

### 3. åŸºç¡€è®¾æ–½

#### Cloudflare D1 æ•°æ®åº“
- **åç§°**ï¼šnews-db
- **ID**ï¼š75430083-6d50-425e-ab5e-eee556ba5c03
- **çŠ¶æ€**ï¼šâœ… å·²åˆ›å»ºï¼ŒåŒ…å« 31 å¼ è¡¨

#### Cloudflare R2 å­˜å‚¨
- **åç§°**ï¼šnews
- **çŠ¶æ€**ï¼šâœ… å·²é…ç½®

#### Cloudflare Queues
- **RSS æŠ“å–é˜Ÿåˆ—**ï¼šrss-fetcher-queue âœ…
- **AI å¤„ç†é˜Ÿåˆ—**ï¼šai-processor-queue âœ…

---

## âš ï¸ å¾…å®Œæˆçš„ç»„ä»¶

### å‰ç«¯ç”¨æˆ·ç•Œé¢ (Next.js)
- **çŠ¶æ€**ï¼šâŒ æ„å»ºå¤±è´¥ï¼Œéœ€è¦ä¿®å¤
- **é—®é¢˜**ï¼šç¼ºå°‘ shadcn/ui ç»„ä»¶åº“
- **è§£å†³æ–¹æ¡ˆ**ï¼šå‚è€ƒ `FRONTEND_DEPLOYMENT_GUIDE.md`

---

## ğŸš€ ç«‹å³å¼€å§‹ä½¿ç”¨

### 1. è®¿é—®ç®¡ç†åå°
```
ç½‘å€ï¼šhttps://moxiang-distill-admin.pages.dev
ç”¨æˆ·åï¼šadmin
å¯†ç ï¼šAdmin@123456
```

### 2. æµ‹è¯• API
```bash
# å¥åº·æ£€æŸ¥
curl https://moxiang-distill.masiqi.workers.dev/api/health

# æ³¨å†Œç”¨æˆ·
curl -X POST https://moxiang-distill.masiqi.workers.dev/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test123456","username":"testuser"}'

# ç™»å½•
curl -X POST https://moxiang-distill.masiqi.workers.dev/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"Test123456"}'
```

---

## ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Cloudflare å…¨çƒè¾¹ç¼˜ç½‘ç»œ                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  ç®¡ç†åå°     â”‚    â”‚   å‰ç«¯åº”ç”¨    â”‚          â”‚
â”‚  â”‚  (Pages)     â”‚    â”‚   (å¾…éƒ¨ç½²)    â”‚          â”‚
â”‚  â”‚  âœ… å·²éƒ¨ç½²    â”‚    â”‚   âŒ å¾…ä¿®å¤   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                   â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                  â”‚                              â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚         â”‚   åç«¯ API       â”‚                     â”‚
â”‚         â”‚   (Workers)     â”‚                     â”‚
â”‚         â”‚   âœ… å·²éƒ¨ç½²      â”‚                     â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                  â”‚                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚    â”‚             â”‚             â”‚               â”‚
â”‚ â”Œâ”€â”€â–¼â”€â”€â”      â”Œâ”€â”€â–¼â”€â”€â”      â”Œâ”€â”€â–¼â”€â”€â”             â”‚
â”‚ â”‚ D1  â”‚      â”‚ R2  â”‚      â”‚Queueâ”‚             â”‚
â”‚ â”‚æ•°æ®åº“â”‚      â”‚å­˜å‚¨  â”‚      â”‚é˜Ÿåˆ—  â”‚             â”‚
â”‚ â”‚ âœ…  â”‚      â”‚ âœ…  â”‚      â”‚ âœ…  â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ é…ç½®å’Œç®¡ç†

### æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
```bash
# Worker çŠ¶æ€
wrangler whoami
wrangler deployments list

# Pages é¡¹ç›®
wrangler pages project list
wrangler pages deployment list --project-name="moxiang-distill-admin"

# D1 æ•°æ®åº“
wrangler d1 list
wrangler d1 execute news-db --command="SELECT COUNT(*) FROM users;"

# é˜Ÿåˆ—
wrangler queues list
```

### æ›´æ–°éƒ¨ç½²
```bash
# æ›´æ–°åç«¯
cd backend
wrangler deploy

# æ›´æ–°ç®¡ç†åå°
cd admin
wrangler pages deploy . --project-name="moxiang-distill-admin" --commit-message="Update"
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# å®æ—¶æ—¥å¿—
wrangler tail

# æŸ¥çœ‹ç‰¹å®š Worker æ—¥å¿—
wrangler tail moxiang-distill
```

---

## ğŸ”’ å®‰å…¨å»ºè®®

### 1. ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 
```bash
# ä½¿ç”¨ wrangler æ›´æ–°å¯†ç 
wrangler secret put ADMIN_PASSWORD
# è¾“å…¥æ–°å¯†ç 
```

### 2. é…ç½® CORSï¼ˆå¦‚éœ€è¦ï¼‰
ç¼–è¾‘ `backend/src/index.ts` ä¸­çš„ CORS é…ç½®

### 3. å¯ç”¨ Cloudflare å®‰å…¨åŠŸèƒ½
- è®¿é—® Cloudflare Dashboard
- å¯ç”¨ WAF (Web Application Firewall)
- é…ç½® Rate Limiting
- å¯ç”¨ Bot Protection

---

## ğŸ“Š ç›‘æ§å’Œå‘Šè­¦

### Cloudflare Analytics
- è®¿é—®ï¼šhttps://dash.cloudflare.com
- æŸ¥çœ‹ Workers å’Œ Pages çš„åˆ†ææ•°æ®

### è‡ªå®šä¹‰ç›‘æ§
```bash
# è®¾ç½®å¥åº·æ£€æŸ¥
watch -n 60 'curl -s https://moxiang-distill.masiqi.workers.dev/api/health'
```

---

## ğŸ› æ•…éšœæ’æŸ¥

### API æ— å“åº”
1. æ£€æŸ¥ Worker çŠ¶æ€ï¼šè®¿é—® Cloudflare Dashboard
2. æŸ¥çœ‹æ—¥å¿—ï¼š`wrangler tail`
3. éªŒè¯ç»‘å®šï¼šç¡®è®¤ D1ã€R2ã€Queues é…ç½®æ­£ç¡®

### ç®¡ç†åå°ç™»å½•å¤±è´¥
1. ç¡®è®¤ API URL é…ç½®ï¼šæ£€æŸ¥ `admin/config.json`
2. éªŒè¯åç«¯å¥åº·ï¼š`curl https://moxiang-distill.masiqi.workers.dev/api/health`
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### æ•°æ®åº“é”™è¯¯
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
wrangler d1 execute news-db --command="SELECT 1;"

# æŸ¥çœ‹è¡¨ç»“æ„
wrangler d1 execute news-db --command="SELECT name FROM sqlite_master WHERE type='table';"
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åç«¯ API æ–‡æ¡£](./backend/README.md)
- [å‰ç«¯éƒ¨ç½²æŒ‡å—](./FRONTEND_DEPLOYMENT_GUIDE.md)
- [æ•°æ®åº“è¿ç§»è„šæœ¬](./backend/migrate-db.sh)
- [éƒ¨ç½²è¯¦ç»†ä¿¡æ¯](./DEPLOYMENT_SUMMARY.md)

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¯åšçš„äº‹æƒ…

1. **âœ… ä½¿ç”¨ç®¡ç†åå°**
   - è®¿é—® https://moxiang-distill-admin.pages.dev
   - ç™»å½•å¹¶ç†Ÿæ‚‰ç•Œé¢
   - æ·»åŠ æµ‹è¯• RSS æº

2. **âœ… æµ‹è¯• API**
   - æ³¨å†Œæµ‹è¯•ç”¨æˆ·
   - æµ‹è¯•ç™»å½•åŠŸèƒ½
   - æ·»åŠ  RSS æº

3. **ğŸ”’ å®‰å…¨åŠ å›º**
   - ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
   - é…ç½® CORS ç­–ç•¥
   - å¯ç”¨ Cloudflare å®‰å…¨åŠŸèƒ½

### éœ€è¦ä¿®å¤çš„å†…å®¹

4. **ğŸ”§ ä¿®å¤å‰ç«¯åº”ç”¨**
   ```bash
   cd frontend
   npx shadcn@latest init
   # æŒ‰æç¤ºå®‰è£…æ‰€éœ€ç»„ä»¶
   ```

5. **ğŸŒ é…ç½®è‡ªå®šä¹‰åŸŸå**
   - ä¸ºç®¡ç†åå°é…ç½®åŸŸå
   - ä¸ºå‰ç«¯é…ç½®åŸŸåï¼ˆä¿®å¤åï¼‰
   - ä¸º API é…ç½®åŸŸåï¼ˆå¯é€‰ï¼‰

6. **ğŸ“Š è®¾ç½®ç›‘æ§**
   - é…ç½® Cloudflare Analytics
   - è®¾ç½®å‘Šè­¦è§„åˆ™
   - é…ç½®æ—¥å¿—æ”¶é›†

---

## ğŸ’¡ ä½¿ç”¨æç¤º

### ç®¡ç†åå°åŠŸèƒ½äº®ç‚¹
- **å®æ—¶æ•°æ®**ï¼šæŸ¥çœ‹æœ€æ–°çš„ RSS æ–‡ç« 
- **æ‰¹é‡æ“ä½œ**ï¼šæ‰¹é‡ç®¡ç† RSS æº
- **AI é…ç½®**ï¼šè°ƒæ•´ AI å¤„ç†å‚æ•°
- **ç”¨æˆ·ç®¡ç†**ï¼šæŸ¥çœ‹å’Œç®¡ç†æ³¨å†Œç”¨æˆ·

### API æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ Cloudflare å…¨çƒè¾¹ç¼˜ç½‘ç»œï¼Œä½å»¶è¿Ÿ
- D1 æ•°æ®åº“è‡ªåŠ¨å¤åˆ¶åˆ°å¤šä¸ªåŒºåŸŸ
- R2 å­˜å‚¨æ”¯æŒå…¨çƒè®¿é—®
- é˜Ÿåˆ—è‡ªåŠ¨å¤„ç†ï¼Œå¼‚æ­¥é«˜æ•ˆ

---

## ğŸ†˜ è·å–å¸®åŠ©

- **Cloudflare æ–‡æ¡£**ï¼šhttps://developers.cloudflare.com
- **é¡¹ç›® Issues**ï¼šhttps://github.com/masiqi/news/issues
- **Wrangler æ–‡æ¡£**ï¼šhttps://developers.cloudflare.com/workers/wrangler/

---

**éƒ¨ç½²æ—¶é—´**ï¼š2025-10-13  
**éƒ¨ç½²çŠ¶æ€**ï¼šæ ¸å¿ƒåŠŸèƒ½å·²ä¸Šçº¿ï¼Œå‰ç«¯å¾…ä¿®å¤  
**å¯ç”¨æ€§**ï¼šåç«¯ API å’Œç®¡ç†åå° 100% å¯ç”¨
