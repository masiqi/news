(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{4774:function(e,t,n){Promise.resolve().then(n.bind(n,7281))},9376:function(e,t,n){"use strict";var s=n(5475);n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})},7281:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var s=n(7437),o=n(2265),r=n(9376),i=n(1837);function a(e){return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}function c(){let e=(0,r.useRouter)(),[t,n]=(0,o.useState)("content"),[c,l]=(0,o.useState)([]),[d,p]=(0,o.useState)([]),[x,h]=(0,o.useState)(!0),[u,m]=(0,o.useState)(""),[g,f]=(0,o.useState)(!1),[y,S]=(0,o.useState)("");(0,o.useEffect)(()=>{if(!localStorage.getItem("auth_token")){e.push("/login");return}j()},[t,e]);let j=async()=>{h(!0),m("");try{if("sources"===t){let e=await i.h.getSources();e.success&&l(e.data||[])}else{let e=await i.h.getContent();e.success&&p(e.data||[])}}catch(e){m("加载数据失败"),console.error("Load data error:",e)}finally{h(!1)}},v=async()=>{if(y.trim())try{(await fetch("".concat("https://moxiang-distill-api.masiqi.workers.dev","/api/sources"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("auth_token"))},body:JSON.stringify({url:y})})).ok?(S(""),f(!1),j()):m("添加 RSS 源失败")}catch(e){m("添加 RSS 源失败"),console.error("Add source error:",e)}};return(0,s.jsxs)("div",{style:{minHeight:"100vh"},children:[(0,s.jsx)("header",{className:"header",children:(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("nav",{className:"nav",children:[(0,s.jsx)("div",{className:"logo",children:"墨香蒸馏"}),(0,s.jsxs)("div",{className:"nav-links",children:[(0,s.jsx)("a",{href:"/dashboard",children:"仪表板"}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("auth_token"),e.push("/")},className:"btn btn-secondary",style:{padding:"8px 16px"},children:"退出登录"})]})]})})}),(0,s.jsxs)("div",{className:"container",style:{paddingTop:"32px"},children:[(0,s.jsx)("div",{style:{marginBottom:"24px",borderBottom:"2px solid #eee"},children:(0,s.jsxs)("div",{style:{display:"flex",gap:"32px"},children:[(0,s.jsx)("button",{onClick:()=>n("content"),style:{padding:"12px 0",border:"none",background:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",borderBottom:"content"===t?"2px solid #0070f3":"2px solid transparent",color:"content"===t?"#0070f3":"#666",marginBottom:"-2px"},children:"内容"}),(0,s.jsx)("button",{onClick:()=>n("sources"),style:{padding:"12px 0",border:"none",background:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",borderBottom:"sources"===t?"2px solid #0070f3":"2px solid transparent",color:"sources"===t?"#0070f3":"#666",marginBottom:"-2px"},children:"RSS 源"})]})}),u&&(0,s.jsx)("div",{style:{padding:"12px 16px",background:"#fee",color:"#c33",borderRadius:"6px",marginBottom:"20px",fontSize:"14px"},children:u}),"sources"===t&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,s.jsx)("h2",{style:{fontSize:"24px",fontWeight:"700"},children:"我的 RSS 源"}),(0,s.jsx)("button",{onClick:()=>f(!g),className:"btn btn-primary",children:g?"取消":"添加 RSS 源"})]}),g&&(0,s.jsxs)("div",{className:"card",style:{marginBottom:"20px"},children:[(0,s.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"添加新的 RSS 源"}),(0,s.jsx)("input",{type:"url",className:"input",value:y,onChange:e=>S(e.target.value),placeholder:"https://example.com/rss",style:{marginBottom:"12px"}}),(0,s.jsx)("button",{onClick:v,className:"btn btn-primary",children:"确认添加"})]}),x?(0,s.jsx)("div",{className:"card",children:"加载中..."}):0===c.length?(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("p",{style:{color:"#666",textAlign:"center"},children:"还没有添加 RSS 源，点击上方按钮添加第一个吧！"})}):c.map(e=>(0,s.jsx)("div",{className:"card",children:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:e.title}),e.description&&(0,s.jsx)("p",{style:{color:"#666",fontSize:"14px",marginBottom:"8px"},children:e.description}),(0,s.jsx)("p",{style:{fontSize:"12px",color:"#999"},children:e.url}),e.lastFetchAt&&(0,s.jsxs)("p",{style:{fontSize:"12px",color:"#999",marginTop:"8px"},children:["最后抓取: ",a(e.lastFetchAt)]})]}),(0,s.jsx)("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"500",background:e.isActive?"#e8f5e9":"#f5f5f5",color:e.isActive?"#2e7d32":"#666"},children:e.isActive?"活跃":"已暂停"})]})},e.id))]}),"content"===t&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"20px"},children:"最新内容"}),x?(0,s.jsx)("div",{className:"card",children:"加载中..."}):0===d.length?(0,s.jsx)("div",{className:"card",children:(0,s.jsx)("p",{style:{color:"#666",textAlign:"center"},children:"还没有内容，添加 RSS 源后系统会自动抓取内容。"})}):d.map(e=>(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.title})}),e.summary&&(0,s.jsx)("p",{style:{color:"#666",fontSize:"14px",marginBottom:"12px",lineHeight:"1.6"},children:e.summary}),(0,s.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginBottom:"8px"},children:e.tags&&e.tags.map((e,t)=>(0,s.jsx)("span",{style:{padding:"2px 8px",background:"#f0f0f0",borderRadius:"4px",fontSize:"12px",color:"#666"},children:e},t))}),(0,s.jsxs)("p",{style:{fontSize:"12px",color:"#999"},children:["发布于: ",a(e.publishedAt)]})]},e.id))]})]})]})}},1837:function(e,t,n){"use strict";async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=localStorage.getItem("auth_token"),s={"Content-Type":"application/json",...t.headers||{}};n&&(s.Authorization="Bearer ".concat(n));let o=await fetch("".concat("https://moxiang-distill-api.masiqi.workers.dev").concat(e),{...t,headers:s});if(!o.ok)throw Error("API错误: ".concat(o.statusText));return o.json()}n.d(t,{h:function(){return o}});let o={register:e=>s("/api/v1/auth/register",{method:"POST",body:JSON.stringify(e)}),login:e=>s("/api/v1/auth/login",{method:"POST",body:JSON.stringify(e)}),getSources:()=>s("/api/v1/sources"),getPublicSources:()=>s("/api/v1/sources/public"),getContent:()=>s("/api/v1/content")}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4774)}),_N_E=e.O()}]);