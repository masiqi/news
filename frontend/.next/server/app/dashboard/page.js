(()=>{var e={};e.id=702,e.ids=[702],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4062:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>o.a,__next_app__:()=>x,originalPathname:()=>c,pages:()=>p,routeModule:()=>h,tree:()=>d}),n(8256),n(2029),n(5866);var s=n(3191),i=n(8716),r=n(7922),o=n.n(r),a=n(5231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);n.d(t,l);let d=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,8256)),"/work/llm/news/frontend/src/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(n.bind(n,2029)),"/work/llm/news/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,5866,23)),"next/dist/client/components/not-found-error"]}],p=["/work/llm/news/frontend/src/app/dashboard/page.tsx"],c="/dashboard/page",x={require:n,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7954:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2994,23)),Promise.resolve().then(n.t.bind(n,6114,23)),Promise.resolve().then(n.t.bind(n,9727,23)),Promise.resolve().then(n.t.bind(n,9671,23)),Promise.resolve().then(n.t.bind(n,1868,23)),Promise.resolve().then(n.t.bind(n,4759,23))},4967:(e,t,n)=>{Promise.resolve().then(n.bind(n,1625))},6463:()=>{},5047:(e,t,n)=>{"use strict";var s=n(7389);n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})},1625:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>d});var s=n(326),i=n(7577),r=n(5047),o=n(8069);function a(e){return new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}function l(e){return e?({positive:"积极",negative:"消极",neutral:"中性",mixed:"复杂",very_positive:"非常积极",very_negative:"非常消极"})[e.toLowerCase()]||e:"未知"}function d(){let e=(0,r.useRouter)(),[t,n]=(0,i.useState)("content"),[d,p]=(0,i.useState)([]),[c,x]=(0,i.useState)([]),[h,u]=(0,i.useState)({page:1,pageSize:20,total:0,totalPages:0}),[g,m]=(0,i.useState)(1),[f,y]=(0,i.useState)(null),[b,j]=(0,i.useState)(!0),[S,v]=(0,i.useState)(""),[k,w]=(0,i.useState)(!1),[C,P]=(0,i.useState)({url:"",name:"",description:"",isPublic:!1}),z=async()=>{j(!0),v("");try{if("sources"===t){let e=await o.h.getSources();e.success&&p(e.data?.sources||e.data||[])}else{let e=await o.h.getContent({page:g,pageSize:20});e.success&&(x(e.contents||[]),e.pagination&&u(e.pagination))}}catch(e){v("加载数据失败"),console.error("Load data error:",e)}finally{j(!1)}},R=async()=>{if(!C.url.trim()){v("RSS地址不能为空");return}if(!C.name.trim()){v("RSS名称不能为空");return}v(""),j(!0);try{let e=await fetch("https://moxiang-distill-api.masiqi.workers.dev/api/v1/sources",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({url:C.url,name:C.name,description:C.description,isPublic:C.isPublic})});if(e.ok)P({url:"",name:"",description:"",isPublic:!1}),w(!1),z();else{let t=await e.json();v(t.error||"添加 RSS 源失败")}}catch(e){v(e?.message||"添加 RSS 源失败"),console.error("Add source error:",e)}finally{j(!1)}},B=async e=>{v(""),j(!0);try{let t=await fetch(`https://moxiang-distill-api.masiqi.workers.dev/api/v1/sources/${e}/trigger-fetch`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),n=await t.json();t.ok?(v(""),alert("抓取任务已提交到队列，请稍后查看结果"),z()):v(n.error||"触发抓取失败")}catch(e){v(e?.message||"触发抓取失败"),console.error("Trigger fetch error:",e)}finally{j(!1)}};return(0,s.jsxs)("div",{style:{minHeight:"100vh"},children:[s.jsx("header",{className:"header",children:s.jsx("div",{className:"container",children:(0,s.jsxs)("nav",{className:"nav",children:[s.jsx("div",{className:"logo",children:"墨香蒸馏"}),(0,s.jsxs)("div",{className:"nav-links",children:[s.jsx("a",{href:"/dashboard",children:"仪表板"}),s.jsx("button",{onClick:()=>{localStorage.removeItem("auth_token"),e.push("/")},className:"btn btn-secondary",style:{padding:"8px 16px"},children:"退出登录"})]})]})})}),(0,s.jsxs)("div",{className:"container",style:{paddingTop:"32px"},children:[s.jsx("div",{style:{marginBottom:"24px",borderBottom:"2px solid #eee"},children:(0,s.jsxs)("div",{style:{display:"flex",gap:"32px"},children:[s.jsx("button",{onClick:()=>n("content"),style:{padding:"12px 0",border:"none",background:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",borderBottom:"content"===t?"2px solid #0070f3":"2px solid transparent",color:"content"===t?"#0070f3":"#666",marginBottom:"-2px"},children:"内容"}),s.jsx("button",{onClick:()=>n("sources"),style:{padding:"12px 0",border:"none",background:"none",fontSize:"16px",fontWeight:"500",cursor:"pointer",borderBottom:"sources"===t?"2px solid #0070f3":"2px solid transparent",color:"sources"===t?"#0070f3":"#666",marginBottom:"-2px"},children:"RSS 源"})]})}),S&&s.jsx("div",{style:{padding:"12px 16px",background:"#fee",color:"#c33",borderRadius:"6px",marginBottom:"20px",fontSize:"14px"},children:S}),"sources"===t&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"24px",fontWeight:"700"},children:"我的 RSS 源"}),s.jsx("button",{onClick:()=>w(!k),className:"btn btn-primary",children:k?"取消":"添加 RSS 源"})]}),k&&(0,s.jsxs)("div",{className:"card",style:{marginBottom:"20px"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"16px"},children:"添加新的 RSS 源"}),(0,s.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,s.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["RSS名称 ",s.jsx("span",{style:{color:"#c33"},children:"*"})]}),s.jsx("input",{type:"text",className:"input",value:C.name,onChange:e=>P({...C,name:e.target.value}),placeholder:"例如：阮一峰的网络日志",required:!0})]}),(0,s.jsxs)("div",{style:{marginBottom:"16px"},children:[(0,s.jsxs)("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:["RSS地址 ",s.jsx("span",{style:{color:"#c33"},children:"*"})]}),s.jsx("input",{type:"url",className:"input",value:C.url,onChange:e=>P({...C,url:e.target.value}),placeholder:"https://example.com/rss.xml",required:!0}),s.jsx("p",{style:{fontSize:"12px",color:"#999",marginTop:"4px"},children:"输入完整的RSS订阅地址"})]}),(0,s.jsxs)("div",{style:{marginBottom:"16px"},children:[s.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500"},children:"描述信息"}),s.jsx("textarea",{className:"input",value:C.description,onChange:e=>P({...C,description:e.target.value}),placeholder:"简要描述这个RSS源的内容（选填）",rows:3,style:{resize:"vertical"}})]}),s.jsx("div",{style:{marginBottom:"20px"},children:(0,s.jsxs)("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[s.jsx("input",{type:"checkbox",checked:C.isPublic,onChange:e=>P({...C,isPublic:e.target.checked}),style:{marginRight:"8px",width:"16px",height:"16px"}}),s.jsx("span",{style:{fontSize:"14px"},children:"设为公开源（其他用户也可以订阅）"})]})}),(0,s.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[s.jsx("button",{onClick:R,className:"btn btn-primary",disabled:b,children:b?"添加中...":"确认添加"}),s.jsx("button",{onClick:()=>{w(!1),P({url:"",name:"",description:"",isPublic:!1}),v("")},className:"btn btn-secondary",disabled:b,children:"取消"})]})]}),b?s.jsx("div",{className:"card",children:"加载中..."}):0===d.length?s.jsx("div",{className:"card",children:s.jsx("p",{style:{color:"#666",textAlign:"center"},children:"还没有添加 RSS 源，点击上方按钮添加第一个吧！"})}):d.map(e=>s.jsx("div",{className:"card",children:(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",gap:"16px"},children:[(0,s.jsxs)("div",{style:{flex:1},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:e.name||e.title}),e.description&&s.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"8px"},children:e.description}),s.jsx("p",{style:{fontSize:"12px",color:"#999"},children:e.url}),e.lastFetchAt&&(0,s.jsxs)("p",{style:{fontSize:"12px",color:"#999",marginTop:"8px"},children:["最后抓取: ",a(e.lastFetchAt)]})]}),(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"flex-end"},children:[s.jsx("span",{style:{padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:"500",background:e.fetchFailureCount<5?"#e8f5e9":"#f5f5f5",color:e.fetchFailureCount<5?"#2e7d32":"#666"},children:e.fetchFailureCount<5?"活跃":"已暂停"}),s.jsx("button",{onClick:()=>B(e.id),className:"btn btn-secondary",style:{padding:"6px 12px",fontSize:"12px"},disabled:b,children:"立即抓取"})]})]})},e.id))]}),"content"===t&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[s.jsx("h2",{style:{fontSize:"24px",fontWeight:"700"},children:"最新内容"}),h.total>0&&(0,s.jsxs)("p",{style:{color:"#666",fontSize:"14px"},children:["共 ",h.total," 条内容"]})]}),b?s.jsx("div",{className:"card",children:"加载中..."}):0===c.length?s.jsx("div",{className:"card",children:s.jsx("p",{style:{color:"#666",textAlign:"center"},children:"还没有内容，添加 RSS 源后系统会自动抓取内容。"})}):(0,s.jsxs)(s.Fragment,{children:[c.map(e=>(0,s.jsxs)("div",{className:"card",style:{cursor:"pointer",transition:"box-shadow 0.2s"},onClick:()=>y(e),onMouseEnter:e=>e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",onMouseLeave:e=>e.currentTarget.style.boxShadow="none",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[s.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",flex:1,marginRight:"16px"},children:e.title}),s.jsx("span",{style:{padding:"4px 8px",background:"#e3f2fd",color:"#1976d2",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap"},children:e.sourceName})]}),e.analysis&&s.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"12px",lineHeight:"1.6"},children:e.analysis.length>200?e.analysis.substring(0,200)+"...":e.analysis}),(0,s.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginBottom:"12px"},children:[e.topics&&e.topics.length>0&&e.topics.slice(0,3).map((e,t)=>(0,s.jsxs)("span",{style:{padding:"4px 10px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"12px",fontSize:"12px",fontWeight:"500"},children:["\uD83D\uDCDA ",e]},t)),e.keywords&&e.keywords.length>0&&e.keywords.slice(0,3).map((e,t)=>(0,s.jsxs)("span",{style:{padding:"4px 10px",background:"#fff3e0",color:"#e65100",borderRadius:"12px",fontSize:"12px"},children:["\uD83D\uDD11 ",e]},t)),e.sentiment&&(0,s.jsxs)("span",{style:{padding:"4px 10px",background:"#f3e5f5",color:"#7b1fa2",borderRadius:"12px",fontSize:"12px"},children:["\uD83D\uDE0A ",l(e.sentiment)]})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("p",{style:{fontSize:"12px",color:"#999"},children:["发布于: ",a(e.publishedAt)]}),s.jsx("span",{style:{fontSize:"12px",color:"#0070f3"},children:"点击查看详情 →"})]})]},e.id)),h.totalPages>1&&(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"12px",marginTop:"32px",padding:"20px 0"},children:[s.jsx("button",{onClick:()=>m(Math.max(1,g-1)),disabled:1===g,className:"btn btn-secondary",style:{padding:"8px 16px",opacity:1===g?.5:1,cursor:1===g?"not-allowed":"pointer"},children:"← 上一页"}),s.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:Array.from({length:Math.min(5,h.totalPages)},(e,t)=>{let n;return n=h.totalPages<=5?t+1:g<=3?t+1:g>=h.totalPages-2?h.totalPages-4+t:g-2+t,s.jsx("button",{onClick:()=>m(n),style:{padding:"8px 12px",border:g===n?"2px solid #0070f3":"1px solid #ddd",borderRadius:"6px",background:g===n?"#0070f3":"white",color:g===n?"white":"#333",cursor:"pointer",fontWeight:g===n?"600":"400",minWidth:"40px"},children:n},n)})}),s.jsx("button",{onClick:()=>m(Math.min(h.totalPages,g+1)),disabled:g===h.totalPages,className:"btn btn-secondary",style:{padding:"8px 16px",opacity:g===h.totalPages?.5:1,cursor:g===h.totalPages?"not-allowed":"pointer"},children:"下一页 →"})]})]})]}),f&&s.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},onClick:()=>y(null),children:(0,s.jsxs)("div",{className:"card",style:{maxWidth:"900px",width:"100%",maxHeight:"90vh",overflow:"auto",position:"relative"},onClick:e=>e.stopPropagation(),children:[s.jsx("button",{onClick:()=>y(null),style:{position:"absolute",top:"16px",right:"16px",background:"#f5f5f5",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",fontSize:"20px",lineHeight:"32px",textAlign:"center"},children:"\xd7"}),s.jsx("div",{style:{marginBottom:"16px"},children:s.jsx("span",{style:{padding:"4px 12px",background:"#e3f2fd",color:"#1976d2",borderRadius:"4px",fontSize:"12px"},children:f.sourceName})}),s.jsx("h2",{style:{fontSize:"24px",fontWeight:"700",marginBottom:"16px",paddingRight:"40px"},children:f.title}),(0,s.jsxs)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap",marginBottom:"20px"},children:[f.topics&&f.topics.map((e,t)=>(0,s.jsxs)("span",{style:{padding:"6px 12px",background:"#e8f5e9",color:"#2e7d32",borderRadius:"16px",fontSize:"13px",fontWeight:"500"},children:["\uD83D\uDCDA ",e]},t)),f.keywords&&f.keywords.map((e,t)=>(0,s.jsxs)("span",{style:{padding:"6px 12px",background:"#fff3e0",color:"#e65100",borderRadius:"16px",fontSize:"13px"},children:["\uD83D\uDD11 ",e]},t))]}),f.sentiment&&(0,s.jsxs)("div",{style:{marginBottom:"20px",padding:"12px",background:"#f3e5f5",borderRadius:"8px"},children:[s.jsx("strong",{style:{color:"#7b1fa2"},children:"情感倾向："}),s.jsx("span",{style:{marginLeft:"8px"},children:l(f.sentiment)})]}),f.analysis&&(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"#333"},children:"\uD83D\uDCDD AI 分析"}),s.jsx("p",{style:{color:"#666",lineHeight:"1.8",whiteSpace:"pre-wrap"},children:f.analysis})]}),f.educationalValue&&(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"#333"},children:"\uD83C\uDF93 教育价值"}),s.jsx("p",{style:{color:"#666",lineHeight:"1.8",whiteSpace:"pre-wrap"},children:f.educationalValue})]}),f.content&&(0,s.jsxs)("div",{style:{marginBottom:"20px"},children:[s.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",marginBottom:"12px",color:"#333"},children:"\uD83D\uDCC4 原文内容"}),s.jsx("div",{style:{color:"#666",lineHeight:"1.8",maxHeight:"400px",overflow:"auto",padding:"16px",background:"#f9f9f9",borderRadius:"8px"},dangerouslySetInnerHTML:{__html:f.content}})]}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"20px",borderTop:"1px solid #eee"},children:[(0,s.jsxs)("div",{style:{fontSize:"13px",color:"#999"},children:[(0,s.jsxs)("p",{children:["发布时间: ",a(f.publishedAt)]}),f.wordCount&&(0,s.jsxs)("p",{style:{marginTop:"4px"},children:["字数: ",f.wordCount]})]}),f.link&&s.jsx("a",{href:f.link,target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",style:{textDecoration:"none"},children:"查看原文 →"})]})]})})]})]})}},8069:(e,t,n)=>{"use strict";async function s(e,t={}){let n={"Content-Type":"application/json",...t.headers||{}},s=await fetch(`https://moxiang-distill-api.masiqi.workers.dev${e}`,{...t,headers:n});if(!s.ok)try{let e=await s.json();throw Error(e.error||e.message||`API错误: ${s.statusText}`)}catch(e){throw Error(`API错误: ${s.statusText}`)}return s.json()}n.d(t,{h:()=>i});let i={register:e=>s("/api/v1/auth/register",{method:"POST",body:JSON.stringify(e)}),login:e=>s("/api/v1/auth/login",{method:"POST",body:JSON.stringify(e)}),getSources:()=>s("/api/v1/sources"),getPublicSources:()=>s("/api/v1/sources/public"),getContent:e=>{let t=new URLSearchParams;e?.page&&t.set("page",e.page.toString()),e?.pageSize&&t.set("pageSize",e.pageSize.toString());let n=t.toString();return s(`/api/v1/content${n?`?${n}`:""}`)}}},8256:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});let s=(0,n(8570).createProxy)(String.raw`/work/llm/news/frontend/src/app/dashboard/page.tsx#default`)},2029:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r,metadata:()=>i});var s=n(9510);n(5023);let i={title:"墨香蒸馏 - AI 新闻平台",description:"基于 AI 的个性化新闻聚合与推送平台"};function r({children:e}){return s.jsx("html",{lang:"zh-CN",children:s.jsx("body",{children:e})})}},5023:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),s=t.X(0,[819],()=>n(4062));module.exports=s})();